---
import Heading from "./Heading.astro";
---

<section class="w-full overflow-hidden relative">
  <!-- Heading -->
  <div class="text-center py-8">
    <Heading htmlheading="h2">Elevhistorier</Heading>
  </div>

  <!-- Slider Container -->
  <div
    class="slider-container flex gap-4 px-4 py-8 overflow-x-auto snap-x snap-mandatory scrollbar-hide"
  >
    <!-- Postcard 1 -->
    <div
      class="postcard-wrapper flex-none w-full md:w-[calc(40%-1rem)] snap-center"
    >
      <img
        src="/img/postcard1.png"
        alt="Student Story 1"
        class="w-full cursor-pointer hover:scale-105 transition-transform"
        onclick="openModal(this.src)"
      />
    </div>
    <!-- Postcard 2 -->
    <div
      class="postcard-wrapper flex-none w-full md:w-[calc(40%-1rem)] snap-center"
    >
      <img
        src="/img/postcard2.png"
        alt="Student Story 2"
        class="w-full cursor-pointer hover:scale-105 transition-transform"
        onclick="openModal(this.src)"
      />
    </div>
    <!-- Postcard 3 -->
    <div
      class="postcard-wrapper flex-none w-full md:w-[calc(40%-1rem)] snap-center"
    >
      <img
        src="/img/postcard3.png"
        alt="Student Story 3"
        class="w-full cursor-pointer hover:scale-105 transition-transform"
        onclick="openModal(this.src)"
      />
    </div>
    <!-- Postcard 4 -->
    <div
      class="postcard-wrapper flex-none w-full md:w-[calc(40%-1rem)] snap-center"
    >
      <img
        src="/img/postcard4.png"
        alt="Student Story 4"
        class="w-full cursor-pointer hover:scale-105 transition-transform"
        onclick="openModal(this.src)"
      />
    </div>
  </div>

  <!-- Modal -->
  <div
    id="imageModal"
    class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center z-50 p-4"
    onclick="closeModal()"
  >
    <div
      class="relative bg-white p-4 md:p-8 rounded-lg shadow-2xl max-w-6xl max-h-[95vh] overflow-auto"
    >
      <img
        id="modalImage"
        src=""
        alt="Enlarged postcard"
        class="w-full h-auto object-contain"
        onclick="event.stopPropagation()"
      />
    </div>
  </div>
</section>

<style>
  /* Hide scrollbar but keep functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Smooth scroll behavior */
  .slider-container {
    scroll-behavior: smooth;
  }
</style>

<script>
  function openModal(imgSrc: string) {
    const modal = document.getElementById("imageModal");
    const modalImg = document.getElementById("modalImage") as HTMLImageElement;
    if (modal && modalImg) {
      modal.classList.remove("hidden");
      modal.classList.add("flex");
      modalImg.src = imgSrc;
      document.body.style.overflow = "hidden"; // Prevent background scrolling
    }
  }

  function closeModal() {
    const modal = document.getElementById("imageModal");
    if (modal) {
      modal.classList.add("hidden");
      modal.classList.remove("flex");
      document.body.style.overflow = ""; // Restore scrolling
    }
  }

  // Close modal with Escape key
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") {
      closeModal();
    }
  });
</script>
